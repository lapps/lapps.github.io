<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="oanc.github.io : GitHub repository for the American National Corpus.">

    <link rel="stylesheet" type="text/css" media="screen" href="/css/slate_numbered.css">
	<script type="text/javascript"
		src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	<!--
	<script type="text/javascript">
		MathJax.Hub.Config({
			jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['%','%'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: false
            },
        });
    </script>	
    -->
    	<script type="text/javascript">
		MathJax.Hub.Config({
			jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['%','%'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: false
            },
        });
    </script>	

    <title>Data Model for LAPPS Licensing</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/lapps">View on GitHub</a>

          <h1 id="project_title">lapps.github.io</h1>
          <h2 id="project_tagline">GitHub repository for the Language Application Grid</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">


	<h1 id="data-model-for-lapps-licensing">Data Model for LAPPS Licensing</h1>

<div class="note">
<span style="color:red">NOTE:</span> This is a rapidly evolving topic and this documentation
is most likely already out of date...
</div>

<p>This page serves as a “worksheet” to sketch out the data structures and algorithms that
will be used to implement the LAPPS licensing model.</p>

<p><a name="toc"></a>
## Table of Contents</p>

<ul>
  <li><a href="#definitions">Definitions</a></li>
  <li><a href="#json">JSON Structures</a>
    <ol>
      <li><a href="#license">License</a></li>
      <li><a href="#request">Request for Access</a></li>
      <li><a href="#denied">Access Denied</a></li>
      <li><a href="#grant">Access Granted</a></li>
    </ol>
  </li>
  <li><a href="#algorithms">Algorithms and Workflows</a>
    <ul>
      <li><a href="#login">Logging In</a></li>
    </ul>
  </li>
</ul>

<p><a name="definitions"></a>
## Definitions</p>

<p><strong>AAS</strong><br />
An Authentication and Authorization Service. Any service that can authenticate a user and
determine if they are authorized to access a particular <em>protected resource</em>.  The <em>AAS</em>
must also return any <em>access constraints</em> that apply to the <em>protected resource</em>.<br /></p>

<p><a name="json"></a>
## JSON Structures</p>

<p><a name="license"></a>
### License</p>

<p>Contains the name of a license, a URI to the full text of the license, and a short
description of the license.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Kitten"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"uri"</span><span class="p">:</span><span class="s2">"http://www.example.com/TheKittenLicense.html"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"You must be nice to kittens."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<div style="text-align:right; padding-top:10px;">
<a href="#toc">toc</a>
</div>

<p><a name="request"></a>
### Request for Access</p>

<p>To access a protected resource the client will first get an authorization token from the 
DataSource AAS that must be presented with future requests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nt">"userid"</span><span class="p">:</span><span class="s2">"Alice"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"resource"</span><span class="p">:</span><span class="s2">"switchboard"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://grid.anc.org:8080/PipelinePlanner/login"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The <em>redirect</em> field indicates the URL that the user should be redirected to after the
authorization process has completed, either successfully or unsuccessfully.</p>

<div class="note">
<span style="color:red">NOTE:</span> The exact workflow used during the authentication
and authorization process is still an open work item.
</div>

<div style="text-align:right; padding-top:10px;">
<a href="#toc">toc</a>
</div>

<p><a name="denied"></a>
### Access Denied</p>

<p>If the user can not be authenticated the data source should return a simple access denied
message. For security reasons the reason for the denial should be as vague as possible:</p>

<ol>
  <li>Access Denied. The user’s credentials could not be verified by the data source. For example
the user is not known to the data source or the user could not provide the correct password.</li>
  <li>Unauthorized. The user’s credentials could be verified, but the user does not have permission
to access the requested resource.</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nt">"error"</span><span class="p">:</span><span class="s2">"Unauthorized"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<div class="note"><span class="red">NOTE:</span> During development and testing data sources
may wish to return more detailed information regarding authorization failures. However,
in production the response to a request for access should be a simple yes or no.</div>

<div style="text-align:right; padding-top:10px;">
<a href="#toc">toc</a>
</div>

<p><a name="grant"></a>
### Resource Authorization</p>

<p>Upon authenticating a user a DataSource AAS will return, amongst other things:</p>

<ol>
  <li>an access token</li>
  <li>a timestamp (GMT relative to the Unix epoch)</li>
  <li>a list of licenses users must agree to</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nt">"userid"</span><span class="p">:</span><span class="s2">"Alice"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"access_token"</span><span class="p">:</span><span class="s2">"9acc8ca4-2506-4d3c-b7ea-3d2a100814f9"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"timestamp"</span><span class="p">:</span><span class="mi">1415992228527</span><span class="p">,</span><span class="w">
	</span><span class="nt">"lifetime"</span><span class="p">:</span><span class="mi">86400000</span><span class="p">,</span><span class="w">
	</span><span class="nt">"resource"</span><span class="p">:</span><span class="s2">"switchboard"</span><span class="p">,</span><span class="w">
	</span><span class="nt">"restrictions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
		</span><span class="p">{</span><span class="w">
			</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Kitten"</span><span class="p">,</span><span class="w">
			</span><span class="nt">"uri"</span><span class="p">:</span><span class="s2">"http://www.example.com/TheKittenLicense.html"</span><span class="p">,</span><span class="w">
			</span><span class="nt">"description"</span><span class="err">,</span><span class="nt">"You must be nice to kittens."</span><span class="w">
		</span><span class="err">}</span><span class="p">,</span><span class="w">
		</span><span class="p">{</span><span class="w">
			</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"CC Attribution"</span><span class="p">,</span><span class="w">
			</span><span class="nt">"uri"</span><span class="p">:</span><span class="s2">"http://creativecommons.org/licenses/by/4.0/legalcode"</span><span class="p">,</span><span class="w">
			</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"Attribution must be given to the original author or authors."</span><span class="w">
		</span><span class="p">}</span><span class="w">
	</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><a name="algorithms"></a>
## Algorithms and Workflows</p>

<p><a name="login"></a>
### Logging In</p>

<ol>
  <li>DataSources will provided a “login” page.</li>
  <li>Clients wishing to access a protected resource on behalf of a user will forward the
user to the datasource’s AAS.</li>
  <li>The AAS will either grant or deny access and return one of the above JSON payloads.</li>
</ol>

<div style="text-align:right; padding-top:10px;">
<a href="#toc">toc</a>
</div>

<h2 id="notes">Notes</h2>

<p>This is left here solely as a reminder of how to use % \latex % math mode in Markdown
pages.</p>

<ul>
  <li>methods to compare instances of the <em>Permissions</em> class.
    <ul>
      <li>For example, if user % U % has permissions % U_p % and resource % R % requires 
  permissions % R_p % to allow access, the user % U % may access the
  resource % R % <em>iff</em> % U_p\bigcap R_p = R_p %</li>
    </ul>
  </li>
</ul>


	
      </section>
    </div>
	<div>
	</div>
    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Copyright &copy; 2017 The Language Application Grid</p>
      </footer>
    </div>

    

  </body>
</html>


