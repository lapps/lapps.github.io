<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="oanc.github.io : GitHub repository for the American National Corpus.">

    <link rel="stylesheet" type="text/css" media="screen" href="/css/slate.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/css/lappsgrid.css"/>
     
	<script type="text/javascript"
		src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
		<script type="text/javascript">
		MathJax.Hub.Config({
			jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['%','%'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: false
            },
        });
    </script>	

    <title>Apache Portable Runtime</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <!-- <a id="forkme_banner" href="https://github.com/lapps">View on GitHub</a> -->
		  <a id="forkme_banner" href="https://github.com/lapps/lapps.github.io/edit/master/apr.md">Edit this page on GitHub</a>.
		  
          <h1 id="project_title">The LAPPS Grid Wiki</h1>
          <h2 id="project_tagline">A framework for interoperable NLP web services.</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">


	<p>The Apache Portable Runtime (APR) and Tomcat Native Libraries are optional components
that give Tomcat access to the Apacheâ€™s socket implementation and random number generator;
both crucial for efficient SSL/TLS.</p>

<p>Installing the APR is relatively simple and should be seriously considered on any 
production Tomcat server.</p>

<ol>
  <li>Downlaod, make and install the APR libraries.</li>
  <li>Download, make and install the Tomcat Native libraries.</li>
  <li>Configure Tomcat to use the new libraries.</li>
  <li>Tweak the server.xml file since the Connector attributes are slightly different.</li>
</ol>

<h3 id="install-apr-libraries">Install APR Libraries</h3>

<p>Installing the APR consists of downloading the source code, compiling and installing.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">&gt; </span>wget http://www.anc.org/downloads/apr-1.5.1.tar.gz
<span class="gp">&gt; </span>tar -xzf apr-1.5.1.tar.gz
<span class="gp">&gt; </span><span class="nb">cd</span> ./apr-1.5.1
<span class="gp">&gt; </span>sudo ./configure
<span class="gp">&gt; </span>sudo make
<span class="gp">&gt; </span>sudo make install
</code></pre>
</div>

<h3 id="install-tomcat-native-libraries">Install Tomcat Native Libraries</h3>

<p>The process for installing the Tomcat libraries is almost identical, except we need to 
tell the configure script where:</p>

<ol>
  <li>the APR libraries are installed,</li>
  <li>where Java is installed (JAVA_HOME) and,</li>
  <li>where Tomcat is installed (CATALINA_HOME).</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">&gt; </span>wget http://www.anc.org/downloads/tomcat-native-1.1.31-src.tar.gz
<span class="gp">&gt; </span>tar -xzf tomcat-native-1.1.31-src.tar.gz
<span class="gp">&gt; </span><span class="nb">cd </span>tomcat-native-1.1.31-src
<span class="gp">&gt; </span>./configure --with-apr<span class="o">=</span>/usr/local/lib/apr/apr-1-config <span class="se">\</span>
            --with-java-home<span class="o">=</span><span class="nv">$JAVA_HOME</span> <span class="se">\</span>
            --with-ssl<span class="o">=</span>yes <span class="se">\</span>
            --prefix<span class="o">=</span><span class="nv">$CATALINA_HOME</span>
<span class="gp">&gt; </span>make
<span class="gp">&gt; </span>make install
</code></pre>
</div>

<p><span class="red">NOTE</span> On my system (Ubuntu 12.04 LTS) the APR libraries were installed
to <tt>/usr/local/lib/apr</tt>.</p>

<h3 id="export-the-libraries">Export the Libraries</h3>

<p>Edit (or create) $CATALINA_HOME/bin/setenv.sh and add the following two lines:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="nv">$CATALINA_HOME</span>/lib
<span class="nb">export </span>LD_LIBRARY_PATH
</code></pre>
</div>

<h3 id="modify-serverxml">Modify server.xml</h3>

<p>TBD.</p>

	
      </section>
    </div>
	<div>
	</div>
    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Copyright &copy; 2017 The Language Application Grid</p>
      </footer>
    </div>

    

  </body>
</html>


